#CC                      := $(CROSS_PREFIX)gcc

TOPDIR                  := $(shell /bin/pwd)

INCLUDES                := -I. -I$(TOPDIR)/include
CROSS_PREFIX			:= arm-none-eabi-

CC                      := $(CROSS_PREFIX)gcc
LD                      := $(CROSS_PREFIX)ld
OBJCOPY                 := $(CROSS_PREFIX)objcopy

CFLAGS                  := -nostdinc
CFLAGS                  += -Wall -O0 -v -g
#CFLAGS                  += --save-temps
CFLAGS                  += $(INCLUDES)

.SUFFIXES : .o .c .S

%.o:%.c
	$(CC) $(CFLAGS) -c $< -o $@

%.o:%.S
	$(CC) $(CFLAGS) -c $< -o $@


cute-boot:start.o 
	#arm-none-eabi-ld start.o -o cute-boot -Ttext 0x00000000
	#arm-none-eabi-objcopy cute-boot cute-boot.bin -O binary
	$(LD) start.o -o cute-boot -Ttext 0x00000000
	$(OBJCOPY) cute-boot cute-boot.bin -O binary

#start.o: start.S
	#arm-none-eabi-gcc start.S -nostdinc -Wall -O0 -c -v -g --save-temps

clean:
	rm -f *.o
	rm -f cute-boot.elf
	rm -f cute-boot.bin




